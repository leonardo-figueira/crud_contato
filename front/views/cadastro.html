<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Cadastro de contatos</title>
    <link rel="stylesheet" href="/lib/bootstrap-5.3.8-dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="/style/datatables.min.css">
    <link rel="stylesheet" href="/lib/bootstrap-icons-1.13.1/bootstrap-icons.css">
    <script type="text/javascript" src="/js/jquery-3.7.1.min.js"></script>
    <script type="text/javascript" src="/lib/bootstrap-5.3.8-dist/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="/js/datatables.min.js"></script>
    <link rel="stylesheet" href="/style/styles.css">
</head>
<body>
    <div class="row">        
        <nav class="nav nav-pills nav-justified">
            <a class="nav-link" aria-current="page" href="http://127.0.0.1:5500/views/lista.html">Lista de Contatos</a>
            <a class="nav-link active" href="#">Cadastrar Contato</a>            
        </nav>
    </div>
    <div class="row">
        <div class="col-md-12">
            <form action="" name="form-contato" id="form-contato">
                <fieldset>
                    <legend>
                        Dados Cadastrais
                    </legend>

                    <label for="txt-nome">
                        Nome
                    </label>
                    <br>
                    <input type="text" name="txt-nome" id="txt-nome" placeholder="Insira aqui o seu nome" required>
                    <br><br>

                    <label for="txt-email">
                        Email
                    </label>
                    <br>
                    <input type="text" name="txt-email" id="txt-email" placeholder="Insira aqui o seu Email" required>
                    <br><br>
                    
                    <label for="txt-dtnascimento">
                        Dt Nascimento
                    </label>
                    <br>
                    <input type="date" name="txt-dtnascimento" id="txt-dtnascimento" required>
                    <br><br>
                    
                    <label>
                        GÃªnero
                    </label>
                    <input type="radio" name="rdo-genero" id="rdo-genero-m" value="M" checked>
                    <label for="rdo-genero-m">
                        Masculino
                    </label>
                    <input type="radio" name="rdo-genero" id="rdo-genero-f" value="F">
                    <label for="rdo-genero-m">
                        Feminino
                    </label>
                    <br><br>
                    
                </fieldset>       

                <br><br>        
                <button id="btn-enviar" type="button" class="btn btn-success">Enviar</button>
            </form>
        </div>
    </div>

    <script type="text/javascript">
        $( document ).ready(function() {

            $("#btn-enviar").on("click", function() {

                const dados = {
                        nome:           $("#txt-nome").val(),
                        email:          $("#txt-email").val(),
                        dt_nascimento:  $("#txt-dtnascimento").val(),
                        genero:         $('input[name="rdo-genero"]:checked').val()
                    };

                console.log(dados);

                $.ajax({
                    url: "http://127.0.0.1:3000/contato",
                    type: "POST",
                    data: JSON.stringify(dados),
                    contentType: "application/json; charset=utf-8",
                    dataType: "json"
                }).done(function(retorno){
                    alert(retorno.msg);
                    window.location.replace("http://127.0.0.1:5500/views/lista.html");
                });

            });
            
        });
    </script>
</body>
</html>
    